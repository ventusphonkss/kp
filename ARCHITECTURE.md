# ğŸ—ºï¸ Deployment Architecture

## Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (Development)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ›ĞĞšĞĞ›Ğ¬ĞĞ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Browser    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  app/        â”‚             â”‚
â”‚  â”‚ localhost:   â”‚         â”‚  index.html  â”‚             â”‚
â”‚  â”‚   8000       â”‚         â”‚  script.js   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚          â”‚                                               â”‚
â”‚          â”‚ API Call                                      â”‚
â”‚          â”‚ (localhost:8080/api/chat)                    â”‚
â”‚          â”‚                                               â”‚
â”‚          â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  proxy.py    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Zenmux AI   â”‚             â”‚
â”‚  â”‚  Flask       â”‚   HTTPS â”‚  API         â”‚             â”‚
â”‚  â”‚  :8080       â”‚         â”‚              â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Production (Vercel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VERCEL CLOUD                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  User Browser                                                â”‚
â”‚       â”‚                                                      â”‚
â”‚       â”‚ HTTPS                                                â”‚
â”‚       â”‚                                                      â”‚
â”‚       â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚   Vercel Edge Network (CDN)   â”‚                          â”‚
â”‚  â”‚   your-project.vercel.app     â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚            â”‚                                                 â”‚
â”‚            â”‚                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚   â”‚                  â”‚                                      â”‚
â”‚   â–¼                  â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Static â”‚    â”‚  Serverless  â”‚                             â”‚
â”‚  â”‚ Files  â”‚    â”‚  Function    â”‚                             â”‚
â”‚  â”‚ app/   â”‚    â”‚ /api/proxy   â”‚â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                     â”‚
â”‚                                       â”‚ HTTPS                â”‚
â”‚                                       â–¼                      â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                               â”‚  Zenmux AI   â”‚              â”‚
â”‚                               â”‚  API         â”‚              â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Request Flow (Production)

```
1. User       â”€â”€â–¶  2. Vercel CDN  â”€â”€â–¶  3. Static Files (app/)
   Browser                                     â”‚
                                               â”‚ (User fills form, 
                                               â”‚  clicks "AI")
                                               â–¼
                                        4. Fetch /api/chat
                                               â”‚
                                               â–¼
                                        5. Serverless Function
                                            (api/proxy.py)
                                               â”‚
                                               â”‚ Add API Key
                                               â”‚
                                               â–¼
                                        6. Zenmux AI API
                                               â”‚
                                               â”‚ Response
                                               â–¼
                                        7. Back to Browser
                                               â”‚
                                               â–¼
                                        8. Render Preview
```

---

## ğŸ”‘ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ñ

### Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾:
- Flask ÑĞµÑ€Ğ²ĞµÑ€ (`proxy.py`) Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 8080
- `script.js` Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ `localhost` Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ `http://localhost:8080/api/chat`

### Production (Vercel):
- Serverless Function (`api/proxy.py`)
- `script.js` Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ production Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ `/api/chat` (Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ)
- Vercel Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€Ğ¾ÑƒÑ‚Ğ¸Ñ‚ `/api/*` â†’ `api/*.py`

---

## âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (vercel.json)

```json
{
  "rewrites": [
    {
      "source": "/api/chat",
      "destination": "/api/proxy.py"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {"key": "Access-Control-Allow-Origin", "value": "*"}
      ]
    }
  ]
}
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**
- ĞŸĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ `/api/chat` â†’ `api/proxy.py`
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ CORS headers ĞºĞ¾ Ğ²ÑĞµĞ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ğ¼

---

## ğŸš¦ Environment Detection (script.js)

```javascript
apiUrl: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
    ? 'http://localhost:8080/api/chat'  // Local Flask
    : '/api/chat',                      // Vercel Serverless
```

**ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚:**
- Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ â†’ Flask proxy
- Production â†’ Serverless function

---

## ğŸ“¦ Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ Ğ½Ğ° Vercel

```
âœ… Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ:
- app/ (ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹)
- api/proxy.py (serverless function)
- vercel.json (ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ)

âŒ ĞĞ• Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ (.gitignore):
- proxy.py (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Flask)
- requirements.txt (Ğ´Ğ»Ñ local dev)
- __pycache__/
- .vscode/
```

---

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ API ĞºĞ»ÑÑ‡Ğ°

### Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ (Ğ² ĞºĞ¾Ğ´Ğµ):
```javascript
// script.js
apiKey: 'sk-ai-v1-2cf03b8d...'  // Hardcoded
```

### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ (Environment Variables):
1. Vercel Dashboard â†’ Settings â†’ Environment Variables
2. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ: `ZENMUX_API_KEY` = `sk-ai-v1-...`
3. Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ `api/proxy.py`:
```python
import os
api_key = os.environ.get('ZENMUX_API_KEY')
```
4. Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ ĞºĞ»ÑÑ‡ Ğ¸Ğ· `script.js` (Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ ÑˆĞ»Ñ‘Ñ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹, Ğ±ÑĞºĞµĞ½Ğ´ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ ĞºĞ»ÑÑ‡)

---

**Ğ’Ñ‹Ğ²Ğ¾Ğ´**: ĞĞ° production ĞĞ• Ğ½ÑƒĞ¶ĞµĞ½ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Flask ÑĞµÑ€Ğ²ĞµÑ€. Vercel Serverless Function Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµÑ‚ `proxy.py`.
